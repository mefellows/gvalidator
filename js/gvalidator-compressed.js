if(typeof(ONEGEEK)=="undefined"){ONEGEEK={};}if(typeof ONEGEEK.forms=="undefined"){ONEGEEK.forms={ENABLE_AUTO_FORM_VALIDATION:true,ENABLE_COMPACT_MESSAGES:true,ICON_ERROR:"../images/icons/cross.png",ICON_OK:"../images/icons/tick.png",ICON_INFO:"../images/icons/help.png",ICON_ALERT:"../images/icons/icon_alert.gif",FIELD_STATUS_ERROR:1,FIELD_STATUS_OK:2,FIELD_STATUS_INFO:3,FIELD_STATUS_NONE:4,};}ONEGEEK.forms.DOMUtilities=function(){if(typeof(Array.prototype.inArray)=="undefined"){Array.prototype.inArray=function(needle){for(key in this){if(this[key]===needle){return true;}}return false;};}this.findPos=function(obj){var curleft=0;var curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop;}while((obj=obj.offsetParent));}return[curleft,curtop];};this.togglePopup=function(source,target){var div=target;var coords=this.findPos(source);if(div.style.display=="block"){div.style.display="none";}else{div.style.position="absolute";div.style.left=coords[0]+10+"px";div.style.top=coords[1]-6+"px";div.style.display="block";}};this.doesElementBelongToClass=function(element,className){var classes=element.className;var pattern=new RegExp(className,"g");if(pattern.test(classes)){return true;}return false;};this.removeClass=function(element,className){var classes=element.className;var regex="\b"+className+"\b";element.className=classes.replace(className,"");};this.addClass=function(element,className){var classes=element.className;if(!this.doesElementBelongToClass(element,className)){element.className+=" "+className;}};this.addEvent=function(element,event,handler){if(element.attachEvent){element.attachEvent("on"+event,handler);}else{if(element.addEventListener){element.addEventListener(event,handler,false);}else{if(!element.id){var date=new Date();element.id=date.getTime();}eval("document.getElementById("+element.id+").on"+event+"="+handler);}}};};var util=new ONEGEEK.forms.DOMUtilities();ONEGEEK.forms.AbstractFormField=function(c){this.field=c||null;this.successMessage="Completed";this.errorMessage="Please complete";this.contextMessage="Please complete";this.messageSpan=null;this.isRequired=false;this.statusImg=null;this.statusLink=null;this.fieldStatus=null;this.modified=false;this.className=null;var b=["errorMessage","successMessage","contextMessage","regex","cleanRegex"];this.setOptions=function(d){for(item in d){if(b.inArray(item)===true){this[item]=d[item];}}};this.setClassName=function(d){this.className=d;};this.setLang=function(g){var d=null;try{this.setOptions(ONEGEEK.forms.GValidator.translation[g]["defaults"]);this.setOptions(ONEGEEK.forms.GValidator.translation[g][this.className]);}catch(f){}};this.setup=function(){if(util.doesElementBelongToClass(this.field,"required")){this.isRequired=true;}this.getMessageSpan();if(ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();util.addEvent(this.field,"blur",this.applyFieldValidation(this));util.addEvent(this.field,"click",this.applyContextInformation(this));util.addEvent(this.field,"change",this.applyFieldModification(this));};this.setForm=function(d){this.form=d;};this.applyFieldModification=function(d){return function(){d.setModified(true);};};this.applyContextInformation=function(d){return function(){var e=d.getMessageSpan();if(e&&d.getModified()===false&&d.getDOMElement.value===""&&d.getContextMessage()){d.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}};};this.applyFieldValidation=function(d){return function(){d.validate();};};this.setModified=function(d){this.modified=d;};this.getModified=function(){return this.modified;};this.reset=function(){this.setModified(false);this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);};this.setState=function(e){util.removeClass(this.messageSpan,"error");util.removeClass(this.messageSpan,"info");util.removeClass(this.messageSpan,"ok");util.removeClass(this.messageSpan,"hidden");if(ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){util.addClass(this.messageSpan,"hidden");}var h="";var g="";var f="";var d=null;switch(e){case ONEGEEK.forms.FIELD_STATUS_ERROR:h=ONEGEEK.forms.ICON_ALERT;f="There are errors with this field. Click for more info.";g="There are errors with this field. Click for more info.";d=this.errorMessage;util.addClass(this.messageSpan,"error");break;case ONEGEEK.forms.FIELD_STATUS_OK:h=ONEGEEK.forms.ICON_OK;f="This field has been completed successfully.";g="This field has been completed successfully.";d=this.successMessage;util.addClass(this.messageSpan,"ok");break;default:h=ONEGEEK.forms.ICON_INFO;f="Click for more information about this field.";g="Click for more information about this field.";d=this.contextMessage;util.addClass(this.messageSpan,"info");}if(ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){this.statusImg.src=h;this.statusImg.alt=f;this.statusImg.title=g;}if(d!==null){this.messageSpan.innerHTML=d;}else{util.addClass(this.messageSpan,"hidden");}};this.createRequiredSpan=function(){var d=document.createElement("span");d.className="required";if(this.isRequired){d.innerHTML="*";}else{d.innerHTML="&nbsp;&nbsp;";}this.field.parentNode.insertBefore(d,this.field.parentNode.firstChild);};this.createFieldStatusIcon=function(){if(this.fieldStatus===null){var f=this.field.parentNode.getElementsByTagName("span");for(var d=0;d<f.length;d++){if(util.doesElementBelongToClass(f[d],"fieldstatus")){this.fieldStatus=f[d];return this.fieldStatus;}}var e=document.createElement("span");e.className="fieldstatus";this.statusImg=document.createElement("img");this.statusImg.src=ONEGEEK.forms.ICON_INFO;this.statusLink=document.createElement("a");this.statusLink.onclick=a(this.statusLink,this.messageSpan);this.statusLink.appendChild(this.statusImg);e.appendChild(this.statusLink);this.fieldStatus=this.field.parentNode.insertBefore(e,this.getMessageSpan());return this.fieldStatus;}else{return this.fieldStatus;}};var a=function(e,d){return function(){util.togglePopup(e,d);};};this.getMessageSpan=function(){if(this.messageSpan===null){var f=this.field.parentNode.getElementsByTagName("span");for(var d=0;d<f.length;d++){if(util.doesElementBelongToClass(f[d],"msg")){this.messageSpan=f[d];return this.messageSpan;}}var e=document.createElement("span");if(!ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){e.className="msg icon info";}else{e.className="msg hidden info";}e.innerHTML=this.contextMessage;this.messageSpan=this.field.parentNode.appendChild(e);return this.messageSpan;}else{return this.messageSpan;}};this.validate=function(){if(this.field.value){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}if(this.modified===false){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}return false;};this.clean=function(){};this.getDOMElement=function(){return this.field;};this.setDOMElement=function(d){this.field=c;};this.getContextMessage=function(){return this.contextMessage;};this.getErrorMessage=function(){return this.errorMessage;};this.getSuccessMessage=function(){return this.successMessage;};this.isRequiredField=function(){return this.isRequired;};};ONEGEEK.forms.FormFieldFactory=function(){var a=new Array();this.lookupFormField=function(b,d){if(a[b]!=null){var c=new (window.ONEGEEK.forms[a[b]["class"]])(d);c.setOptions(a[b].options);return c;}return null;};this.registerFormField=function(d,c,b){if(a[d]!=null){alert("FormFieldFactory registerFormField(): Cannot register field ("+d+"), as this namespace is in use");return;}a[d]={"class":c,options:b};};};var formFieldFactory=new ONEGEEK.forms.FormFieldFactory();ONEGEEK.forms.AbstractComboBox=function(a){this.field=a;this.validate=function(){if(this.field.value&&this.field.value!==""){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}if(this.modified===false||!this.isRequired){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}return false;};this.setup=function(){if(util.doesElementBelongToClass(this.field,"required")){this.isRequired=true;}this.getMessageSpan();if(ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();util.addEvent(this.field,"click",this.applyFieldValidation(this));util.addEvent(this.field,"blur",this.applyFieldValidation(this));util.addEvent(this.field,"click",this.applyContextInformation(this));util.addEvent(this.field,"change",this.applyFieldModification(this));};};ONEGEEK.forms.AbstractComboBox.prototype=new ONEGEEK.forms.AbstractFormField();formFieldFactory.registerFormField("select","AbstractComboBox");formFieldFactory.registerFormField("combo","AbstractComboBox");ONEGEEK.forms.AbstractCheckbox=function(a){this.field=a;this.clean=function(){};this.validate=function(){var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){if(b[i].checked){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}else{if(this.modified!==true||!this.isRequired){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}}}return false;};this.setup=function(){if(util.doesElementBelongToClass(this.field,"required")){this.isRequired=true;}this.getMessageSpan();if(ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){util.addEvent(b[i],"click",this.applyFieldValidation(this));util.addEvent(b[i],"click",this.applyContextInformation(this));util.addEvent(b[i],"change",this.applyFieldModification(this));}};};ONEGEEK.forms.AbstractCheckbox.prototype=new ONEGEEK.forms.AbstractFormField();formFieldFactory.registerFormField("checkbox","AbstractCheckbox");ONEGEEK.forms.AbstractRadioButton=function(a){this.field=a;this.clean=function(){};this.setup=function(){if(util.doesElementBelongToClass(this.field,"required")){this.isRequired=true;}this.getMessageSpan();if(ONEGEEK.forms.ENABLE_COMPACT_MESSAGES){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){util.addEvent(b[i],"click",this.applyFieldValidation(this));util.addEvent(b[i],"click",this.applyContextInformation(this));util.addEvent(b[i],"change",this.applyFieldModification(this));}};this.validate=function(){var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){if(b[i].checked){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}else{if(this.modified!==true||!this.isRequired){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}}}return false;};};ONEGEEK.forms.AbstractRadioButton.prototype=new ONEGEEK.forms.AbstractFormField();formFieldFactory.registerFormField("radio","AbstractRadioButton");ONEGEEK.forms.AbstractTextField=function(a){this.field=a;this.regex="";this.cleanRegex="";this.pattern=null;this.validate=function(){if(this.field.value){this.clean();this.pattern=new RegExp(this.regex);var b=this.pattern.test(this.field.value);if(b){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}return b;}if(this.modified===false||this.isRequired===false){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}return false;};this.clean=function(){this.field.value=this.field.value.replace(this.cleanRegex,"");};};ONEGEEK.forms.AbstractTextField.prototype=new ONEGEEK.forms.AbstractFormField();ONEGEEK.forms.NameField=function(a){this.field=a;this.regex=/^([a-zA-Z\-\'\s]{2,30})$/g;this.cleanRegex=/[^a-zA-Z\-\'\s]/g;this.errorMessage="Your name must be between 2 and 30 characters";this.contextMessage="We would like to call you by your name";};ONEGEEK.forms.NameField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("firstname","NameField");formFieldFactory.registerFormField("lastname","NameField");formFieldFactory.registerFormField("name","NameField");ONEGEEK.forms.PhoneField=function(a){this.field=a;this.regex=/^([0-9]{8,10})$/g;this.cleanRegex=/[^0-9]/g;this.errorMessage="Your phone number needs to be at least 8 digits long i.e. 03 1234 5678";this.contextMessage=this.errorMessage;};ONEGEEK.forms.PhoneField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("phone","PhoneField");ONEGEEK.forms.EmailField=function(a){this.field=a;this.regex=/^[A-Z0-9._%+\-]+@[A-Z0-9.\-]+\.[A-Z]{2,4}$/i;this.errorMessage="Please enter a valid email address i.e. user@domain.com";this.contextMessage="Your email address will be kept confidential";this.clean=function(){};};ONEGEEK.forms.EmailField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("email","EmailField");ONEGEEK.forms.GenericTextField=function(a){this.field=a;this.regex=/^.*$/;this.cleanRegex=/[<>\/\\\(\);]/g;};ONEGEEK.forms.GenericTextField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("text","GenericTextField");formFieldFactory.registerFormField("generictext","GenericTextField");ONEGEEK.forms.CaptchaTextField=function(a){this.field=a;this.regex=/^([A-Za-z0-9\-_]+)$/g;this.cleanRegex=/[<>\/\\\(\);]/g;this.successMessage="Thankyou...";this.errorMessage="Please complete the security check";this.contextMessage="This prevents us from spam";};ONEGEEK.forms.CaptchaTextField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("captcha","CaptchaTextField");ONEGEEK.forms.RecaptchaTextField=function(a){this.field=a;this.contextMessage="Need some <a href='javascript:Recaptcha.showhelp()'>help</a>? Get another <a href='javascript:Recaptcha.reload()'>CAPTCHA</a>";};ONEGEEK.forms.RecaptchaTextField.prototype=new ONEGEEK.forms.CaptchaTextField();formFieldFactory.registerFormField("recaptcha_response_field",new ONEGEEK.forms.RecaptchaTextField());formFieldFactory.registerFormField("recaptcha","RecaptchaTextField");ONEGEEK.forms.Form=function(d){var a=new Array();d=d||document.getElementById(d)||null;var b=false;this.lang=null;this.getForm=function(){return d;};this.reset=function(){for(var e=0;e<a.length;e++){a[e].reset();}};this.validate=function(k){var j=null;for(var f=0;f<a.length;f++){a[f].setModified(true);var h=a[f].validate();if(!h&&a[f].isRequiredField()){if(!j){j=a[f].getDOMElement();}}}if(j){j.focus();alert("Please correct the highlighted errors.");return false;}var g=d.getElementsByTagName("input");for(f=0;f<g.length;f++){if(g[f].type=="submit"){g[f].setProperty("lastvalue",g[f].value);g[f].disabled=true;g[f].value="Please wait...";}}return true;};this.getFormId=function(){return id;};var c=function(e){var g=null;for(var f=0;f<a.length;f++){if(a[f].getDOMElement().name==e){return a[f].getDOMElement();}}return g;};this.doForm=function(){if(d){this.lang=(d.lang!==null&&d.lang!="EN")?d.lang:null;var f=d.getElementsByTagName("input");for(var h=0;h<f.length;h++){this.doFormField(f[h]);}var e=d.getElementsByTagName("textarea");for(h=0;h<e.length;h++){this.doFormField(e[h]);}var g=d.getElementsByTagName("select");for(h=0;h<g.length;h++){this.doFormField(g[h]);}util.addEvent(d,"submit",this.validate);util.addEvent(d,"reset",this.reset);}};this.doFormField=function(l){if(l&&l.type=="text"||l.type=="password"||l.type=="textarea"||l.type=="select-one"||l.type=="select-multiple"||l.type=="checkbox"||l.type=="file"||l.type=="radio"){if(!c(l.name)){var k=l.className;var g=null;var e=0;if(k.indexOf(" ")>-1){var h=k.split(" ");do{k=h[e];g=formFieldFactory.lookupFormField(k,l);e++;}while(g===null&&e<h.length);}else{g=formFieldFactory.lookupFormField(k,l);}if(g){g.setClassName(k);if(this.lang!==null){g.setLang(this.lang);}var f=g.getDOMElement();g.setup();g.setForm(this);a[a.length]=g;}}}};};ONEGEEK.forms.GValidator=function(){this.readOptions=function(){};this.readPlugins=function(){for(item in ONEGEEK.forms.GValidator.plugins){formFieldFactory.registerFormField(item,ONEGEEK.forms.GValidator.plugins[item]._extends,ONEGEEK.forms.GValidator.plugins[item]);}};this.autoApplyFormValidation=function(){var a=document.getElementsByTagName("form");for(i=0;i<a.length;i++){if(a[i].className=="autoform"||a[i].className=="gform"){var b=new ONEGEEK.forms.Form(a[i]);b.doForm();}}};this.readOptions();this.readPlugins();};if(typeof(ONEGEEK.forms.GValidator.translation)=="undefined"){ONEGEEK.forms.GValidator.translation={};}function addLoadEventGVal(a){var b=window.onload;if(typeof window.onload!="function"){window.onload=a;}else{window.onload=function(){if(b){b();}a();};}}addLoadEventGVal(function(){if(ONEGEEK.forms.ENABLE_AUTO_FORM_VALIDATION){gvalidator=new ONEGEEK.forms.GValidator();gvalidator.autoApplyFormValidation();}});