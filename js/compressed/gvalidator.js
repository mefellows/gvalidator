if(typeof(ONEGEEK)=="undefined"){ONEGEEK={};}if(typeof ONEGEEK.forms=="undefined"){ONEGEEK.forms={FIELD_STATUS_RESET:0,FIELD_STATUS_ERROR:1,FIELD_STATUS_OK:2,FIELD_STATUS_INFO:3,FIELD_STATUS_NONE:4,FIELD_STATUS_EMPTY:5};}Function.prototype.gbind=function(b,a){var c=this;return function(){return c.apply(b,a);};};Element.prototype.findPos=function(){var c=0;var a=0;var b=this;if(b.offsetParent){do{c+=b.offsetLeft;a+=b.offsetTop;}while((b=b.offsetParent));}return[c,a];};Element.prototype.hasClass=function(b){var a=this.className;var c=new RegExp(b,"g");if(c.test(a)){return true;}return false;};Element.prototype.removeClass=function(b){var a=this.className;var c="\b"+b+"\b";this.className=a.replace(b,"");};Element.prototype.addClass=function(b){var a=this.className;if(!this.hasClass(b)){this.className+=" "+b;}};Element.prototype.addEvent=function(event,handler){if(this.attachEvent){this.attachEvent("on"+event,handler);}else{if(this.addEventListener){this.addEventListener(event,handler,false);}else{if(!this.id){var date=new Date();this.id=date.getTime();}eval("document.getElementById("+this.id+").on"+event+"="+handler);}}};Element.prototype.togglePopup=function(b){var c=b;var a=this.findPos;if(!c.hasClass("hidden")){c.addClass("hidden");}else{c.style.position="absolute";c.style.left=a[0]+10+"px";c.style.top=a[1]-6+"px";c.removeClass("hidden");}};Function.prototype.gbind=function(b,a){var c=this;return function(){return c.apply(b,a);};};Array.prototype.gcontains=function(a){for(key in this){if(this[key]===a){return true;}}return false;};ONEGEEK.forms.AbstractFormField=function(c){this.field=c||null;this.successMsg="Completed";this.errorMsg="Please complete";this.contextMsg="Please complete";this.emptyMsg="%field% is required, please complete";this.msgSpan=null;this.isRequired=false;this.statusImg=null;this.statusLink=null;this.fieldStatus=null;this.modified=false;this.className=null;var b=["errorMsg","emptyMsg","successMsg","contextMsg","regex","cleanRegex"];this.form=null;this.state=null;this.setOptions=function(d){for(item in d){if(b.gcontains(item)===true){this[item]=d[item];}}};this.setClassName=function(d){this.className=d;};this.setLang=function(g){g=g.toUpperCase();var d=null;try{this.setOptions(ONEGEEK.forms.GValidator.translation[g].defaults);this.setOptions(ONEGEEK.forms.GValidator.translation[g][this.className]);}catch(f){}};this.setup=function(){if(this.field.hasClass("required")){this.isRequired=true;}this.getMsgSpan();if(this.form.options.eMsgFormat=="compact"){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();this.field.addEvent("blur",this.applyFieldValidation(this));this.field.addEvent("click",this.applyContextInformation(this));this.field.addEvent("change",this.applyFieldModification(this));this.setLabel();};this.setLabel=function(){try{if(this.field.type!="checkbox"&&this.field.type!="radio"){var k=this.form.getForm().getElementsByTagName("label");for(var f=0;f<k.length;f++){if(k[f].getAttribute("for")==this.field.id){this.label=k[f].innerHTML;return true;}}}var h=this.field.parentNode;var d="";do{d=h.tagName.toLowerCase();if(d=="fieldset"){var g=h.getElementsByTagName("legend");if(g.length>0){this.label=g[0].innerHTML;return true;}}h=h.parentNode;}while(h&&d!="form");}catch(j){this.label="Field";return false;}this.label="Field";return false;};this.setForm=function(d){this.form=d;};this.applyFieldModification=function(d){return function(){d.setModified(true);};};this.applyContextInformation=function(d){return function(){var e=d.getMsgSpan();if(e&&d.getModified()===false&&d.getDOMElement.value===""&&d.contextMsg){d.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}};};this.applyFieldValidation=function(d){return function(){d.validate();};};this.setModified=function(d){this.modified=d;};this.getModified=function(){return this.modified;};this.reset=function(){this.setModified(false);this.setState(ONEGEEK.forms.FIELD_STATUS_RESET);};this.setState=function(e){this.state=e;this.msgSpan.removeClass("error");this.msgSpan.removeClass("info");this.msgSpan.removeClass("ok");var h="";var g="";var f="";var d=null;switch(e){case ONEGEEK.forms.FIELD_STATUS_EMPTY:h=this.form.options.icons.error;f="There are errors with this field. Click for more info.";g="There are errors with this field. Click for more info.";this.emptyMsg=this.emptyMsg.replace("%field%","'"+this.label+"'");d=this.emptyMsg;this.msgSpan.addClass("error");break;case ONEGEEK.forms.FIELD_STATUS_ERROR:h=this.form.options.icons.error;f="There are errors with this field. Click for more info.";g="There are errors with this field. Click for more info.";d=this.errorMsg;this.msgSpan.addClass("error");break;case ONEGEEK.forms.FIELD_STATUS_OK:h=this.form.options.icons.ok;f="This field has been completed successfully.";g="This field has been completed successfully.";d=this.successMsg;this.msgSpan.addClass("ok");break;case ONEGEEK.forms.FIELD_STATUS_RESET:if(this.form.options.eMsgFormat=="compact"){this.msgSpan.addClass("hidden");}default:h=this.form.options.icons.info;f="Click for more information about this field.";g="Click for more information about this field.";d=this.contextMsg;this.msgSpan.addClass("info");}if(this.form.options.eMsgFormat=="compact"){this.statusImg.src=h;this.statusImg.alt=f;this.statusImg.title=g;}if(d!==null){this.msgSpan.innerHTML=d;}else{this.msgSpan.addClass("hidden");}};this.createRequiredSpan=function(){if(this.form.options.reqShow){var d=document.createElement("span");d.className="required";if(this.isRequired){d.innerHTML=this.form.options.reqChar;}else{d.innerHTML=" &nbsp;";}if(this.form.options.reqPlacement=="before"){this.field.parentNode.insertBefore(d,this.field.parentNode.firstChild);}else{this.field.parentNode.insertBefore(d,this.field);}}};this.createFieldStatusIcon=function(){if(this.fieldStatus===null){var f=this.field.parentNode.getElementsByTagName("span");for(var d=0;d<f.length;d++){if(f[d].hasClass("fieldstatus")){this.fieldStatus=f[d];return this.fieldStatus;}}var e=document.createElement("span");e.className="fieldstatus";this.statusImg=document.createElement("img");this.statusImg.src=this.form.options.icons.info;this.statusLink=document.createElement("a");this.statusLink.addEvent(this.form.options.eMsgEventOn,a(this.statusLink,this.msgSpan));if(this.form.options.eMsgEventOff!==null){this.statusLink.addEvent(this.form.options.eMsgEventOff,a(this.statusLink,this.msgSpan));}this.statusLink.appendChild(this.statusImg);e.appendChild(this.statusLink);this.fieldStatus=this.field.parentNode.insertBefore(e,this.getMsgSpan());return this.fieldStatus;}else{return this.fieldStatus;}};var a=function(e,d){return function(){e.togglePopup(d);};};this.getMsgSpan=function(){if(this.msgSpan===null){var f=this.field.parentNode.getElementsByTagName("span");for(var d=0;d<f.length;d++){if(f[d].hasClass("msg")){this.msgSpan=f[d];return this.msgSpan;}}var e=document.createElement("span");if(this.form.options.eMsgFormat=="compact"){e.className="msg hidden info";}else{e.className="msg icon info";}e.innerHTML=this.contextMsg;this.msgSpan=this.field.parentNode.appendChild(e);}return this.msgSpan;};this.validate=function(){if(this.field.value){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}if(this.modified===false){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_EMPTY);}return false;};this.clean=function(){};this.getDOMElement=function(){return this.field;};this.isRequiredField=function(){return this.isRequired;};};ONEGEEK.forms.FormFieldFactory=function(){var a=new Array();this.lookupFormField=function(b,d){if(a[b]!=null){var c=new (window.ONEGEEK.forms[a[b]["class"]])(d);c.setOptions(a[b].options);return c;}return null;};this.registerFormField=function(d,c,b){if(a[d]!=null){alert("FormFieldFactory registerFormField(): Cannot register field ("+d+"), as this namespace is in use");return;}a[d]={"class":c,options:b};};};var formFieldFactory=new ONEGEEK.forms.FormFieldFactory();ONEGEEK.forms.ComboBox=function(a){this.field=a;this.validate=function(){if(this.field.value&&this.field.value!==""){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}if(this.modified===false||!this.isRequired){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_EMPTY);}return false;};this.setup=function(){if(this.field.hasClass("required")){this.isRequired=true;}this.getMsgSpan();if(this.form.options.eMsgFormat=="compact"){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();this.field.addEvent("click",this.applyFieldValidation(this));this.field.addEvent("blur",this.applyFieldValidation(this));this.field.addEvent("click",this.applyContextInformation(this));this.field.addEvent("change",this.applyFieldModification(this));this.setLabel();};};ONEGEEK.forms.ComboBox.prototype=new ONEGEEK.forms.AbstractFormField();formFieldFactory.registerFormField("select","ComboBox");formFieldFactory.registerFormField("combo","ComboBox");ONEGEEK.forms.Checkbox=function(a){this.field=a;this.clean=function(){};this.validate=function(){var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){if(b[i].checked){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}else{if(this.modified!==true||!this.isRequired){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_EMPTY);}}}return false;};this.setup=function(){if(this.field.hasClass("required")){this.isRequired=true;}this.getMsgSpan();if(this.form.options.eMsgFormat=="compact"){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){b[i].addEvent("click",this.applyFieldValidation(this));b[i].addEvent("click",this.applyContextInformation(this));b[i].addEvent("change",this.applyFieldModification(this));}this.setLabel();};};ONEGEEK.forms.Checkbox.prototype=new ONEGEEK.forms.AbstractFormField();formFieldFactory.registerFormField("checkbox","Checkbox");ONEGEEK.forms.RadioButton=function(a){this.field=a;this.clean=function(){};this.setup=function(){if(this.field.hasClass("required")){this.isRequired=true;}this.getMsgSpan();if(this.form.options.eMsgFormat=="compact"){this.createFieldStatusIcon();}this.createRequiredSpan();this.validate();var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){b[i].addEvent("click",this.applyFieldValidation(this));b[i].addEvent("click",this.applyContextInformation(this));b[i].addEvent("change",this.applyFieldModification(this));}this.setLabel();};this.validate=function(){var b=document.forms[0].elements[this.field.name];for(i=0;i<b.length;i++){if(b[i].checked){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);return true;}else{if(this.modified!==true||!this.isRequired){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_EMPTY);}}}return false;};};ONEGEEK.forms.RadioButton.prototype=new ONEGEEK.forms.AbstractFormField();formFieldFactory.registerFormField("radio","RadioButton");ONEGEEK.forms.AbstractTextField=function(a){this.field=a;this.regex="";this.cleanRegex="";this.pattern=null;this.validate=function(){if(this.field.value){this.clean();this.pattern=new RegExp(this.regex);var b=this.pattern.test(this.field.value);if(b){this.setState(ONEGEEK.forms.FIELD_STATUS_OK);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_ERROR);}return b;}if(this.modified===false||this.isRequired===false){this.setState(ONEGEEK.forms.FIELD_STATUS_INFO);}else{this.setState(ONEGEEK.forms.FIELD_STATUS_EMPTY);}return false;};this.clean=function(){this.field.value=this.field.value.replace(this.cleanRegex,"");};};ONEGEEK.forms.AbstractTextField.prototype=new ONEGEEK.forms.AbstractFormField();ONEGEEK.forms.NameField=function(a){this.field=a;this.regex=/^([a-zA-Z\-\'\s]{2,30})$/g;this.cleanRegex=/[^a-zA-Z\-\'\s]/g;this.errorMsg="Your name must be between 2 and 30 characters";this.contextMsg="Please enter your name";};ONEGEEK.forms.NameField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("firstname","NameField");formFieldFactory.registerFormField("lastname","NameField");formFieldFactory.registerFormField("name","NameField");ONEGEEK.forms.PhoneField=function(a){this.field=a;this.regex=/^([0-9]{8,10})$/g;this.cleanRegex=/[^0-9]/g;this.errorMsg="Your phone number needs to be at least 8 digits long i.e. 03 1234 5678";this.contextMsg=this.errorMsg;};ONEGEEK.forms.PhoneField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("phone","PhoneField");ONEGEEK.forms.EmailField=function(a){this.field=a;this.regex=/^[A-Z0-9._%+\-]+@[A-Z0-9.\-]+\.[A-Z]{2,4}$/i;this.errorMsg="Please enter a valid email address i.e. user@domain.com";this.contextMsg="Your email address will be kept confidential";this.clean=function(){};};ONEGEEK.forms.EmailField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("email","EmailField");ONEGEEK.forms.GenericTextField=function(a){this.field=a;this.regex=/^.*$/;this.cleanRegex=/[<>\/\\\(\);]/g;};ONEGEEK.forms.GenericTextField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("text","GenericTextField");formFieldFactory.registerFormField("generictext","GenericTextField");ONEGEEK.forms.CaptchaTextField=function(a){this.field=a;this.regex=/^([A-Za-z0-9\-_]+)$/g;this.cleanRegex=/[<>\/\\\(\);]/g;this.successMsg="Thankyou.";this.errorMsg="Please complete the security check";this.contextMsg="This prevents us from spam";};ONEGEEK.forms.CaptchaTextField.prototype=new ONEGEEK.forms.AbstractTextField();formFieldFactory.registerFormField("captcha","CaptchaTextField");ONEGEEK.forms.RecaptchaTextField=function(a){this.field=a;this.contextMsg="Need some <a href='javascript:Recaptcha.showhelp()'>help</a>? Get another <a href='javascript:Recaptcha.reload()'>CAPTCHA</a>";this.errorMsg="Please complete. [Get another <a href='javascript:Recaptcha.reload()'>CAPTCHA</a>]";};ONEGEEK.forms.RecaptchaTextField.prototype=new ONEGEEK.forms.CaptchaTextField();formFieldFactory.registerFormField("recaptcha_response_field","RecaptchaTextField");formFieldFactory.registerFormField("recaptcha","RecaptchaTextField");ONEGEEK.forms.Form=function(e){var a=new Array();var c=e||document.getElementById(e)||null;this.lang=null;this.custom=false;var d=["autoFocus","eMsgEventOn","eMsgEventOff","eMsgFormat","icons","error","info","ok","eMsgFunction","fMsg","fMsgFormat","reqShow","reqChar","reqPlacement","supressAlert"];this.options={icons:{ok:"../images/icons/tick.png",info:"../images/icons/help.png",error:"../images/icons/icon_alert.gif"},reqShow:true,reqChar:"*",reqPlacement:"after",fMsgFormat:"alert",fMsg:"Please correct the highlighted errors.",eMsgFormat:"open",eMsgEventOn:"click",eMsgEventOff:null,autoFocus:true};this.readOptions=function(f){this.options=this._readOptionsRecursive(this.options,f);};this._readOptionsRecursive=function(g,f){for(var j in f){if(d.gcontains(j)){try{if(typeof(f[j])=="object"){g[j]=this._readOptionsRecursive(g[j],f[j]);}else{g[j]=f[j];}}catch(h){g[j]=f[j];}}}return g;};this.setOptions=function(){try{this.readOptions(ONEGEEK.forms.GValidator.options);if(this.custom===true){this.readOptions(ONEGEEK.forms.GValidator.options[c.id]);}}catch(f){}};this.reset=function(){for(var f=0;f<a.length;f++){a[f].reset();}};this.getForm=function(){return c;};this.handleErrors=function(g){if(this.options.supressAlert!==true){alert(this.options.fMsg);}switch(typeof(this.options.fMsgFormat)){case"string":var k=document.getElementById("gvErrorsList");var m=document.getElementById(this.options.fMsgFormat);if(!m){break;}var h=document.createElement("ul");h.id="gvErrorsList";for(var j=0;j<g.length;j++){var f=document.createElement("li");if(g[j].state===ONEGEEK.forms.FIELD_STATUS_ERROR){f.innerHTML=g[j].errorMsg;}else{f.innerHTML=g[j].emptyMsg;}h.appendChild(f);}if(k){m.replaceChild(h,k);}else{m.appendChild(h);}m.removeClass("hidden");window.location="#"+this.options.fMsgFormat;break;case"function":return this.options.fMsgFormat(g);default:break;}return false;};this.validate=function(){var j=null;var l=[];var k=[];for(var f=0;f<a.length;f++){a[f].setModified(true);var h=a[f].validate();if(!h&&a[f].isRequiredField()){l[l.length]=a[f];k[k.length]=a[f].getDOMElement();}}if(l[0]){k[0].focus();this.handleErrors(l);return false;}var g=c.getElementsByTagName("input");for(f=0;f<g.length;f++){if(g[f].type=="submit"){g[f].disabled=true;g[f].value="Please wait...";}}return true;};this.applyFocus=function(){if(this.options.autoFocus===true){var f=document.getElementsByTagName("input");if(f.length>0){f[0].focus();}}};var b=function(f){var h=null;for(var g=0;g<a.length;g++){if(a[g].getDOMElement().name==f){return a[g].getDOMElement();}}return h;};this.doForm=function(){if(c){this.lang=(c.lang)?c.lang:null;if(c.hasClass("custom")){this.custom=true;}this.setOptions();var g=c.getElementsByTagName("input");for(var j=0;j<g.length;j++){this.doFormField(g[j]);}var f=c.getElementsByTagName("textarea");for(j=0;j<f.length;j++){this.doFormField(f[j]);}var h=c.getElementsByTagName("select");for(j=0;j<h.length;j++){this.doFormField(h[j]);}c.onsubmit=this.validate.gbind(this);c.addEvent("reset",this.reset.gbind(this));}};this.doFormField=function(m){if(m&&m.type=="text"||m.type=="password"||m.type=="textarea"||m.type=="select-one"||m.type=="select-multiple"||m.type=="checkbox"||m.type=="file"||m.type=="radio"){if(!b(m.name)){var l=m.className;var h=null;var f=0;if(l.indexOf(" ")>-1){var k=l.split(" ");do{l=k[f];h=formFieldFactory.lookupFormField(l,m);f++;}while(h===null&&f<k.length);}else{h=formFieldFactory.lookupFormField(l,m);}if(h){h.setClassName(l);if(this.lang!==null){h.setLang(this.lang);}var g=h.getDOMElement();h.setForm(this);h.setup();a[a.length]=h;}}}};};ONEGEEK.forms.GValidator=function(){var a=[];this.readPlugins=function(){for(item in ONEGEEK.forms.GValidator.plugins){formFieldFactory.registerFormField(item,ONEGEEK.forms.GValidator.plugins[item]._extends,ONEGEEK.forms.GValidator.plugins[item]);}};this.applyFocus=function(){if(a.length>0){a[0].applyFocus();}};this.autoApplyFormValidation=function(){var b=document.getElementsByTagName("form");for(var c=0;c<b.length;c++){if(b[c].hasClass("autoform")||b[c].hasClass("gform")){a[c]=new ONEGEEK.forms.Form(b[c]);a[c].doForm();}}this.applyFocus();};this.readPlugins();};if(typeof(ONEGEEK.forms.GValidator.translation)=="undefined"){ONEGEEK.forms.GValidator.translation={};}function addLoadEventGVal(a){var b=window.onload;if(typeof window.onload!="function"){window.onload=a;}else{window.onload=function(){if(b){b();}a();};}}addLoadEventGVal(function(){gvalidator=new ONEGEEK.forms.GValidator();gvalidator.autoApplyFormValidation();});